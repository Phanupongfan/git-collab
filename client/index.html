<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card API Client</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.0/axios.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin-bottom: 30px; padding: 20px; border: 1px solid #ccc; }
        input, textarea, button { margin: 5px; padding: 8px; }
        button { background: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background: #0056b3; }
        .card-item { border: 1px solid #ddd; margin: 10px 0; padding: 10px; }
        .card-item img { width: 100px; height: auto; }
        .result { background: #f8f9fa; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Card API Client</h1>

    <!-- GET All Cards -->
    <div class="section">
        <h2>GET - ดึงการ์ดทั้งหมด</h2>
        <button onclick="getAllCards()">ดึงการ์ดทั้งหมด</button>
        <div id="allCards"></div>
    </div>

    <!-- GET Card by ID -->
    <div class="section">
        <h2>GET - ดึงการ์ดตาม ID</h2>
        <input type="number" id="getCardId" placeholder="Card ID">
        <button onclick="getCardById()">ดึงการ์ด</button>
        <div id="singleCard"></div>
    </div>

    <!-- POST - Add New Card -->
    <div class="section">
        <h2>POST - เพิ่มการ์ดใหม่</h2>
        <input type="text" id="newCardName" placeholder="ชื่อการ์ด"><br>
        <input type="number" id="newCardPrice" placeholder="ราคา"><br>
        <input type="url" id="newCardImage" placeholder="URL รูปภาพ"><br>
        <textarea id="newCardDescription" placeholder="คำอธิบาย" rows="3" cols="50"></textarea><br>
        <button onclick="addCard()">เพิ่มการ์ด</button>
        <div id="addResult"></div>
    </div>

    <!-- PUT - Update Card -->
    <div class="section">
        <h2>PUT - แก้ไขการ์ด</h2>
        <input type="number" id="updateCardId" placeholder="Card ID ที่จะแก้ไข"><br>
        <input type="text" id="updateCardName" placeholder="ชื่อการ์ดใหม่"><br>
        <input type="number" id="updateCardPrice" placeholder="ราคาใหม่"><br>
        <input type="url" id="updateCardImage" placeholder="URL รูปภาพใหม่"><br>
        <textarea id="updateCardDescription" placeholder="คำอธิบายใหม่" rows="3" cols="50"></textarea><br>
        <button onclick="updateCard()">แก้ไขการ์ด</button>
        <div id="updateResult"></div>
    </div>

    <!-- DELETE Card -->
    <div class="section">
        <h2>DELETE - ลบการ์ด</h2>
        <input type="number" id="deleteCardId" placeholder="Card ID ที่จะลบ">
        <button onclick="deleteCard()">ลบการ์ด</button>
        <div id="deleteResult"></div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:3003';

        // GET - ดึงการ์ดทั้งหมด
        async function getAllCards() {
            try {
                const response = await axios.get(`${API_BASE_URL}/cards`);
                const cards = response.data;
                
                let html = '<h3>รายการการ์ดทั้งหมด:</h3>';
                cards.forEach(card => {
                    html += `
                        <div class="card-item">
                            <h4>${card.name} (ID: ${card.id})</h4>
                            <p>ราคา: ${card.price} บาท</p>
                            <p>คำอธิบาย: ${card.description}</p>
                            <img src="${card.image}" alt="${card.name}">
                        </div>
                    `;
                });
                
                document.getElementById('allCards').innerHTML = html;
            } catch (error) {
                document.getElementById('allCards').innerHTML = `<div class="result">Error: ${error.message}</div>`;
            }
        }

        // GET - ดึงการ์ดตาม ID
        async function getCardById() {
            const id = document.getElementById('getCardId').value;
            if (!id) {
                alert('กรุณาใส่ Card ID');
                return;
            }

            try {
                const response = await axios.get(`${API_BASE_URL}/cards/${id}`);
                const card = response.data;
                
                const html = `
                    <div class="result">
                        <h3>${card.name} (ID: ${card.id})</h3>
                        <p>ราคา: ${card.price} บาท</p>
                        <p>คำอธิบาย: ${card.description}</p>
                        <img src="${card.image}" alt="${card.name}">
                    </div>
                `;
                
                document.getElementById('singleCard').innerHTML = html;
            } catch (error) {
                document.getElementById('singleCard').innerHTML = `<div class="result">Error: ${error.response?.data || error.message}</div>`;
            }
        }

        // POST - เพิ่มการ์ดใหม่
        async function addCard() {
            const name = document.getElementById('newCardName').value;
            const price = document.getElementById('newCardPrice').value;
            const image = document.getElementById('newCardImage').value;
            const description = document.getElementById('newCardDescription').value;

            if (!name || !price || !image || !description) {
                alert('กรุณากรอกข้อมูลให้ครบ');
                return;
            }

            try {
                const response = await axios.post(`${API_BASE_URL}/cards`, {
                    name,
                    price: parseInt(price),
                    image,
                    description
                });

                const newCard = response.data;
                document.getElementById('addResult').innerHTML = `
                    <div class="result">
                        <h3>เพิ่มการ์ดสำเร็จ!</h3>
                        <p>ID: ${newCard.id}</p>
                        <p>ชื่อ: ${newCard.name}</p>
                        <p>ราคา: ${newCard.price} บาท</p>
                    </div>
                `;

                // ล้างฟอร์ม
                document.getElementById('newCardName').value = '';
                document.getElementById('newCardPrice').value = '';
                document.getElementById('newCardImage').value = '';
                document.getElementById('newCardDescription').value = '';
            } catch (error) {
                document.getElementById('addResult').innerHTML = `<div class="result">Error: ${error.message}</div>`;
            }
        }

        // PUT - แก้ไขการ์ด
        async function updateCard() {
            const id = document.getElementById('updateCardId').value;
            const name = document.getElementById('updateCardName').value;
            const price = document.getElementById('updateCardPrice').value;
            const image = document.getElementById('updateCardImage').value;
            const description = document.getElementById('updateCardDescription').value;

            if (!id) {
                alert('กรุณาใส่ Card ID');
                return;
            }

            const updateData = {};
            if (name) updateData.name = name;
            if (price) updateData.price = parseInt(price);
            if (image) updateData.image = image;
            if (description) updateData.description = description;

            try {
                const response = await axios.put(`${API_BASE_URL}/cards/${id}`, updateData);
                const updatedCard = response.data;
                
                document.getElementById('updateResult').innerHTML = `
                    <div class="result">
                        <h3>แก้ไขการ์ดสำเร็จ!</h3>
                        <p>ID: ${updatedCard.id}</p>
                        <p>ชื่อ: ${updatedCard.name}</p>
                        <p>ราคา: ${updatedCard.price} บาท</p>
                        <p>คำอธิบาย: ${updatedCard.description}</p>
                    </div>
                `;

                // ล้างฟอร์ม
                document.getElementById('updateCardId').value = '';
                document.getElementById('updateCardName').value = '';
                document.getElementById('updateCardPrice').value = '';
                document.getElementById('updateCardImage').value = '';
                document.getElementById('updateCardDescription').value = '';
            } catch (error) {
                document.getElementById('updateResult').innerHTML = `<div class="result">Error: ${error.response?.data || error.message}</div>`;
            }
        }

        // DELETE - ลบการ์ด
        async function deleteCard() {
            const id = document.getElementById('deleteCardId').value;
            if (!id) {
                alert('กรุณาใส่ Card ID');
                return;
            }

            if (!confirm('คุณแน่ใจหรือไม่ที่จะลบการ์ดนี้?')) {
                return;
            }

            try {
                const response = await axios.delete(`${API_BASE_URL}/cards/${id}`);
                
                document.getElementById('deleteResult').innerHTML = `
                    <div class="result">
                        <h3>ลบการ์ดสำเร็จ!</h3>
                        <p>การ์ด ID ${id} ถูกลบแล้ว</p>
                    </div>
                `;

                document.getElementById('deleteCardId').value = '';
            } catch (error) {
                document.getElementById('deleteResult').innerHTML = `<div class="result">Error: ${error.response?.data || error.message}</div>`;
            }
        }

        // โหลดการ์ดทั้งหมดตอนเริ่มต้น
        window.onload = function() {
            getAllCards();
        };
    </script>
</body>
</html>